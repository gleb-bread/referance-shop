import{f as I,m as j,B as G,j as E,M as H,l as B,b as i,K as b,aT as U,Y as F,b7 as K,bk as q,a0 as S,a1 as Y,$ as P,aA as Q,aB as X,ai as V,aj as Z,F as x,n as ee,aD as te,bl as ae,bm as re,bn as se,bo as ne,bp as ie}from"./entry.43b58f78.js";function oe(e){return{aspectStyles:b(()=>{const a=Number(e.aspectRatio);return a?{paddingBottom:String(1/a*100)+"%"}:void 0})}}const k=I({aspectRatio:[String,Number],contentClass:String,inline:Boolean,...j(),...G()},"VResponsive"),$=E()({name:"VResponsive",props:k(),setup(e,a){let{slots:r}=a;const{aspectStyles:t}=oe(e),{dimensionStyles:c}=H(e);return B(()=>{var n;return i("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[c.value,e.style]},[i("div",{class:"v-responsive__sizer",style:t.value},null),(n=r.additional)==null?void 0:n.call(r),r.default&&i("div",{class:["v-responsive__content",e.contentClass]},[r.default()])])}),{}}}),le=I({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),y=(e,a)=>{let{slots:r}=a;const{transition:t,disabled:c,...n}=e,{component:o=K,...d}=typeof t=="object"?t:{};return U(o,F(typeof t=="string"?{name:c?"":t}:d,n,{disabled:c}),r)};function ue(e,a){if(!q)return;const r=a.modifiers||{},t=a.value,{handler:c,options:n}=typeof t=="object"?t:{handler:t,options:{}},o=new IntersectionObserver(function(){var f;let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],m=arguments.length>1?arguments[1]:void 0;const l=(f=e._observe)==null?void 0:f[a.instance.$.uid];if(!l)return;const g=d.some(_=>_.isIntersecting);c&&(!r.quiet||l.init)&&(!r.once||g||l.init)&&c(g,d,m),g&&r.once?D(e,a):l.init=!0},n);e._observe=Object(e._observe),e._observe[a.instance.$.uid]={init:!1,observer:o},o.observe(e)}function D(e,a){var t;const r=(t=e._observe)==null?void 0:t[a.instance.$.uid];r&&(r.observer.unobserve(e),delete e._observe[a.instance.$.uid])}const ce={mounted:ue,unmounted:D},de=ce,ge=I({alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,...k(),...j(),...le()},"VImg"),he=E()({name:"VImg",directives:{intersect:de},props:ge(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,a){let{emit:r,slots:t}=a;const c=S(""),n=Y(),o=S(e.eager?"loading":"idle"),d=S(),m=S(),l=b(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),g=b(()=>l.value.aspect||d.value/m.value||0);P(()=>e.src,()=>{f(o.value!=="idle")}),P(g,(s,u)=>{!s&&u&&n.value&&h(n.value)}),Q(()=>f());function f(s){if(!(e.eager&&s)&&!(q&&!s&&!e.eager)){if(o.value="loading",l.value.lazySrc){const u=new Image;u.src=l.value.lazySrc,h(u,null)}l.value.src&&X(()=>{var u,v;if(r("loadstart",((u=n.value)==null?void 0:u.currentSrc)||l.value.src),(v=n.value)!=null&&v.complete){if(n.value.naturalWidth||p(),o.value==="error")return;g.value||h(n.value,null),_()}else g.value||h(n.value),w()})}}function _(){var s;w(),o.value="loaded",r("load",((s=n.value)==null?void 0:s.currentSrc)||l.value.src)}function p(){var s;o.value="error",r("error",((s=n.value)==null?void 0:s.currentSrc)||l.value.src)}function w(){const s=n.value;s&&(c.value=s.currentSrc||s.src)}let z=-1;function h(s){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const v=()=>{clearTimeout(z);const{naturalHeight:T,naturalWidth:C}=s;T||C?(d.value=C,m.value=T):!s.complete&&o.value==="loading"&&u!=null?z=window.setTimeout(v,u):(s.currentSrc.endsWith(".svg")||s.currentSrc.startsWith("data:image/svg+xml"))&&(d.value=1,m.value=1)};v()}const R=b(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),L=()=>{var v;if(!l.value.src||o.value==="idle")return null;const s=i("img",{class:["v-img__img",R.value],src:l.value.src,srcset:l.value.srcset,alt:e.alt,sizes:e.sizes,ref:n,onLoad:_,onError:p},null),u=(v=t.sources)==null?void 0:v.call(t);return i(y,{transition:e.transition,appear:!0},{default:()=>[V(u?i("picture",{class:"v-img__picture"},[u,s]):s,[[te,o.value==="loaded"]])]})},W=()=>i(y,{transition:e.transition},{default:()=>[l.value.lazySrc&&o.value!=="loaded"&&i("img",{class:["v-img__img","v-img__img--preload",R.value],src:l.value.lazySrc,alt:e.alt},null)]}),A=()=>t.placeholder?i(y,{transition:e.transition,appear:!0},{default:()=>[(o.value==="loading"||o.value==="error"&&!t.error)&&i("div",{class:"v-img__placeholder"},[t.placeholder()])]}):null,J=()=>t.error?i(y,{transition:e.transition,appear:!0},{default:()=>[o.value==="error"&&i("div",{class:"v-img__error"},[t.error()])]}):null,M=()=>e.gradient?i("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,O=S(!1);{const s=P(g,u=>{u&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{O.value=!0})}),s())})}return B(()=>{const[s]=$.filterProps(e);return V(i($,F({class:["v-img",{"v-img--booting":!O.value},e.class],style:[{width:ee(e.width==="auto"?d.value:e.width)},e.style]},s,{aspectRatio:g.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>i(x,null,[i(L,null,null),i(W,null,null),i(M,null,null),i(A,null,null),i(J,null,null)]),default:t.default}),[[Z("intersect"),{handler:f,options:e.options},null,{once:!0}]])}),{currentSrc:c,image:n,state:o,naturalWidth:d,naturalHeight:m}}}),ve={products:[],categories:{},imagesForCategory:{},loading:!1,update:!1,errorLoading:!1,errorUpdate:!1},me={getParserProducts(e){return e.products},getParserCategories(e){return e.categories},getParserImageCategories(e){return e.imagesForCategory},getLoading(e){return e.loading},getError(e){return e.errorLoading}},N=async function(e,a){const r=ae("user_token");console.log();let t=se.sait;t[t.length-1]!="/"&&(t=t+"/"),e[e.length-1]=="/"&&(e=e.substring(0,e.length-1)),a={...a,query:{...a.query,user_token:r}};const{data:c,error:n}=await re(`${t}${e}`,a,"$ErTr1ttAwh");return c},fe={async setParserProducts(e,a={page:1}){e.loading=!0;const{data:r}=await ne("parsingProducts",async()=>{await $fetch("api/parser_products",{method:"GET",query:a})});if(r.value){let t=Se(r.value);e.products=t,e.loading=!1,e.errorLoading=!1}else e.loading=!1},async setParserCategories(e){e.loading=!0;const a=await N("api/parser_products/categories",{method:"GET",query:{}});if(a.value){let r=JSON.parse(a.value);e.categories=r,e.loading=!1,e.errorLoading=!1}else e.loading=!1},async setImgOnCategory(e){const a=await N("api/parser_products/images",{method:"GET",query:{}});if(a.value){let r=JSON.parse(a.value);e.imagesForCategory=r}}};function Se(e){let a=JSON.parse(e);return a.forEach(r=>{Object.keys(r).forEach(t=>{(t=="characteristics"||t=="images"||t=="variants")&&r[t]&&(r[t]=JSON.parse(r[t]))})}),a}const ye=ie("products",{state:()=>ve,getters:me,actions:fe});export{de as I,y as M,he as V,le as m,ye as u};
