import{f as I,m as j,B as G,j as E,M as H,l as F,b as n,K as b,aT as U,Y as B,b7 as K,bk as q,a0 as S,a1 as Y,$ as P,aA as Q,aB as X,ai as V,aj as Z,F as x,n as ee,aD as te,bl as ae,bm as re,bn as se,bo as ne}from"./entry.8e2d85b4.js";function ie(e){return{aspectStyles:b(()=>{const r=Number(e.aspectRatio);return r?{paddingBottom:String(1/r*100)+"%"}:void 0})}}const k=I({aspectRatio:[String,Number],contentClass:String,inline:Boolean,...j(),...G()},"VResponsive"),$=E()({name:"VResponsive",props:k(),setup(e,r){let{slots:t}=r;const{aspectStyles:a}=ie(e),{dimensionStyles:c}=H(e);return F(()=>{var i;return n("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[c.value,e.style]},[n("div",{class:"v-responsive__sizer",style:a.value},null),(i=t.additional)==null?void 0:i.call(t),t.default&&n("div",{class:["v-responsive__content",e.contentClass]},[t.default()])])}),{}}}),oe=I({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),y=(e,r)=>{let{slots:t}=r;const{transition:a,disabled:c,...i}=e,{component:o=K,...d}=typeof a=="object"?a:{};return U(o,B(typeof a=="string"?{name:c?"":a}:d,i,{disabled:c}),t)};function le(e,r){if(!q)return;const t=r.modifiers||{},a=r.value,{handler:c,options:i}=typeof a=="object"?a:{handler:a,options:{}},o=new IntersectionObserver(function(){var f;let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],m=arguments.length>1?arguments[1]:void 0;const l=(f=e._observe)==null?void 0:f[r.instance.$.uid];if(!l)return;const g=d.some(h=>h.isIntersecting);c&&(!t.quiet||l.init)&&(!t.once||g||l.init)&&c(g,d,m),g&&t.once?D(e,r):l.init=!0},i);e._observe=Object(e._observe),e._observe[r.instance.$.uid]={init:!1,observer:o},o.observe(e)}function D(e,r){var a;const t=(a=e._observe)==null?void 0:a[r.instance.$.uid];t&&(t.observer.unobserve(e),delete e._observe[r.instance.$.uid])}const ue={mounted:le,unmounted:D},ce=ue,de=I({alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,...k(),...j(),...oe()},"VImg"),_e=E()({name:"VImg",directives:{intersect:ce},props:de(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,r){let{emit:t,slots:a}=r;const c=S(""),i=Y(),o=S(e.eager?"loading":"idle"),d=S(),m=S(),l=b(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),g=b(()=>l.value.aspect||d.value/m.value||0);P(()=>e.src,()=>{f(o.value!=="idle")}),P(g,(s,u)=>{!s&&u&&i.value&&_(i.value)}),Q(()=>f());function f(s){if(!(e.eager&&s)&&!(q&&!s&&!e.eager)){if(o.value="loading",l.value.lazySrc){const u=new Image;u.src=l.value.lazySrc,_(u,null)}l.value.src&&X(()=>{var u,v;if(t("loadstart",((u=i.value)==null?void 0:u.currentSrc)||l.value.src),(v=i.value)!=null&&v.complete){if(i.value.naturalWidth||p(),o.value==="error")return;g.value||_(i.value,null),h()}else g.value||_(i.value),w()})}}function h(){var s;w(),o.value="loaded",t("load",((s=i.value)==null?void 0:s.currentSrc)||l.value.src)}function p(){var s;o.value="error",t("error",((s=i.value)==null?void 0:s.currentSrc)||l.value.src)}function w(){const s=i.value;s&&(c.value=s.currentSrc||s.src)}let z=-1;function _(s){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const v=()=>{clearTimeout(z);const{naturalHeight:O,naturalWidth:T}=s;O||T?(d.value=T,m.value=O):!s.complete&&o.value==="loading"&&u!=null?z=window.setTimeout(v,u):(s.currentSrc.endsWith(".svg")||s.currentSrc.startsWith("data:image/svg+xml"))&&(d.value=1,m.value=1)};v()}const R=b(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),L=()=>{var v;if(!l.value.src||o.value==="idle")return null;const s=n("img",{class:["v-img__img",R.value],src:l.value.src,srcset:l.value.srcset,alt:e.alt,sizes:e.sizes,ref:i,onLoad:h,onError:p},null),u=(v=a.sources)==null?void 0:v.call(a);return n(y,{transition:e.transition,appear:!0},{default:()=>[V(u?n("picture",{class:"v-img__picture"},[u,s]):s,[[te,o.value==="loaded"]])]})},W=()=>n(y,{transition:e.transition},{default:()=>[l.value.lazySrc&&o.value!=="loaded"&&n("img",{class:["v-img__img","v-img__img--preload",R.value],src:l.value.lazySrc,alt:e.alt},null)]}),A=()=>a.placeholder?n(y,{transition:e.transition,appear:!0},{default:()=>[(o.value==="loading"||o.value==="error"&&!a.error)&&n("div",{class:"v-img__placeholder"},[a.placeholder()])]}):null,J=()=>a.error?n(y,{transition:e.transition,appear:!0},{default:()=>[o.value==="error"&&n("div",{class:"v-img__error"},[a.error()])]}):null,M=()=>e.gradient?n("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,C=S(!1);{const s=P(g,u=>{u&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{C.value=!0})}),s())})}return F(()=>{const[s]=$.filterProps(e);return V(n($,B({class:["v-img",{"v-img--booting":!C.value},e.class],style:[{width:ee(e.width==="auto"?d.value:e.width)},e.style]},s,{aspectRatio:g.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>n(x,null,[n(L,null,null),n(W,null,null),n(M,null,null),n(A,null,null),n(J,null,null)]),default:a.default}),[[Z("intersect"),{handler:f,options:e.options},null,{once:!0}]])}),{currentSrc:c,image:i,state:o,naturalWidth:d,naturalHeight:m}}}),ge={products:[],categories:{},imagesForCategory:{},loading:!1,update:!1,errorLoading:!1,errorUpdate:!1},ve={getParserProducts(e){return e.products},getParserCategories(e){return e.categories},getParserImageCategories(e){return e.imagesForCategory},getLoading(e){return e.loading},getError(e){return e.errorLoading}},me={sait:"http://localhost:8888//"},N=async function(e,r){let t=me.sait;t[t.length-1]!="/"&&(t=t+"/"),e[e.length-1]=="/"&&(e=e.substring(0,e.length-1)),r={...r,query:{...r.query,user_token:ae("user_token")}};const{data:a}=await re(`${t}${e}`,r,"$ErTr1ttAwh");return a},fe={async setParserProducts(e,r={page:1}){e.loading=!0;const{data:t}=se("parsingProducts",async()=>{await $fetch("api/parser_products",{method:"GET",query:r})});if(console.log(t),t.value){let a=Se(t.value);e.products=a,e.loading=!1,e.errorLoading=!1}else e.loading=!1},async setParserCategories(e){e.loading=!0;const r=await N("api/parser_products/categories",{method:"GET",query:{}});if(r.value){let t=JSON.parse(r.value);e.categories=t,e.loading=!1,e.errorLoading=!1}else e.loading=!1},async setImgOnCategory(e){const r=await N("api/parser_products/images",{method:"GET",query:{}});if(r.value){let t=JSON.parse(r.value);e.imagesForCategory=t,console.log(e.imagesForCategory)}}};function Se(e){let r=JSON.parse(e);return r.forEach(t=>{Object.keys(t).forEach(a=>{(a=="characteristics"||a=="images"||a=="variants")&&t[a]&&(t[a]=JSON.parse(t[a]))})}),r}const ye=ne("products",{state:()=>ge,getters:ve,actions:fe});export{ce as I,y as M,_e as V,oe as m,ye as u};
